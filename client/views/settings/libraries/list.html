<div class="page page-table" data-ng-controller="libraryCtrl">

    <section class="panel panel-default">
        <div class="panel-heading">
            <strong>
                <span class="glyphicon glyphicon-th"></span> Reference Library
            </strong>
            <div class="pull-right header-buttons">
                <a ng-click="openModal();" class="btn btn-success btn-sm"> <i class="fa fa-plus"></i> ADD</a>
            </div>
        </div>

        <div class="panel-body">

            <table  st-pipe="referencesTable" st-table="libReferences" class="table table-bordered table-striped table-responsive">
                <thead>
                <tr>
                    <th class="col-md-1" st-sort="title">Title</th>
                    <th class="col-md-1" st-sort="description">Description</th>
                    <th class="col-md-1" st-sort="tags.text">Author</th>
                    <th class="col-md-1" st-sort="filename">File Name</th>
                    <th class="col-md-1" st-sort="updatedAt">Tags</th>
                    <th class="col-md-1">View</th>
                    <th class="col-md-2">Actions</th>
                </tr>
                <tr>
                    <th class="search-group"><i class="fa fa-search"></i><input class="form-control search-field" placeholder="Search" st-search="title"/>
                    </th>
                    <th class="search-group"><i class="fa fa-search"></i><input class="form-control search-field" placeholder="Search"
                               st-search="description"/>
                    </th>
                    <th class="search-group"><i class="fa fa-search"></i><input class="form-control search-field" placeholder="Search"
                               st-search="author"/>
                    </th>
                    <th class="search-group"><i class="fa fa-search"></i><input class="form-control search-field" placeholder="Search"
                               st-search="filename"/>
                    </th>
                    <th class="search-group"><i class="fa fa-search"></i><input class="form-control search-field" placeholder="Search"
                               st-search="tags"/>
                    </th>
                    <th></th>
                    <th></th>
                </tr>
                </thead>

                <tbody ng-show="!isLoading">
                <tr ng-repeat="record in libReferences">
                    <td>{{record.title}}</td>
                    <td>{{record.description}}</td>
                    <td>{{record.author}}</td>
                    <td>
                        <p ng-show="record.mimetype">{{record.filename}}</p>
                        <p ng-show="!record.mimetype">N/A</p>
                    </td>
                    <td>{{record.tags}}</td>
                    <td>
                        <button ng-if="record.type" ng-show="record.mimetype"
                                class="btn btn-sm btn-default text-center"
                                ng-click="preview(record)">
                            <i class="fa fa-file" aria-hidden="true"></i> View File
                        </button>
                        <h4 class="text-center">
                            <a ng-if="!record.type && !record.links" href="http://{{shortUrl(record.url)}}"
                               target="_blank">Download</a>
                        </h4>
                        <a ng-show="record.links"
                           class="btn btn-sm btn-info text-center"
                           href="http://{{shortUrl(record.links)}}"
                           target="_blank"> <i class="fa fa-link"></i> Open Link</a>
                    </td>
                    <td>
                        <a class="btn btn-sm btn-primary" ng-click="viewModalTimeout(record.id)"><span class="fa fa-television"></span></a>
                        <a class="btn btn-sm btn-info" ng-click="callAtTimeout(record.id,$index)"><span class="fa fa-pencil-square-o"></span></a>
                        <a class="btn btn-sm btn-danger" confirm = "Are you sure to delete this entry?" ng-click="deleteModal(record.id)" ><span class="fa fa fa-times"></span></a>
                    </td>
                </tr>
                </tbody>
                <tbody ng-show="isLoading">
                <tr>
                    <td colspan="4" class="text-center">Loading ... </td>
                </tr>
                </tbody>
                <tfoot class="table table-striped table-responsive">
                <tr>
                    <td class="text-center" st-pagination="" st-items-by-page="pageItems" colspan="7">
                    </td>
                </tr>
                </tfoot>
            </table>
            <div class="col-md-3">
                <select class="form-control"
                        ng-model="pageItems"
                        ng-options="item.val as item.name for item in items"
                        ng-selected="item.val === pageItems">
                </select>
            </div>
        </div>
    </section>
</div>
